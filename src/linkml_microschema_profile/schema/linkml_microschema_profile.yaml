---
id: https://w3id.org/linkml/linkml-microschema-profile
name: linkml-microschema-profile
title: LinkML Microschema Profile
version: "0.2.0"
description: |-
  A LinkML schema defining the Microschema Profile for composable data elements.
  Microschemas are designed for inline composition without identifiers.
license: MIT
see_also:
  - https://linkml.github.io/linkml-microschema-profile

prefixes:
  coms: https://w3id.org/linkml/linkml-microschema-profile/
  linkml: https://w3id.org/linkml/
  schema: http://schema.org/
  PATO: http://purl.obolibrary.org/obo/PATO_
  bdchm: https://w3id.org/bdchm/
  OBA: http://purl.obolibrary.org/obo/OBA_
  OMOP: https://athena.ohdsi.org/search-terms/terms/
  LOINC: https://loinc.org/
  UCUM: https://units-of-measurement.org/
  UBERON: http://purl.obolibrary.org/obo/UBERON_
  MONDO: http://purl.obolibrary.org/obo/MONDO_
  HP: http://purl.obolibrary.org/obo/HP_
  RxNorm: http://purl.bioontology.org/ontology/RXNORM/
  ISO11179: http://purl.org/iso11179/
  example: http://www.example.org/rdf#
default_prefix: coms
default_range: string

imports:
  - linkml:types

classes:

  #────────────────────────────────────────────────────────────────
  # METACLASSES: Define what makes a class a "Microschema"
  #────────────────────────────────────────────────────────────────

  MicroschemaDefinition:
    class_uri: coms:MicroschemaDefinition
    abstract: true
    description: >-
      A metaclass for classes that conform to the Microschema profile.
      Classes that instantiate this are designed for inline composition.
    comments:
      - Classes instantiating this SHOULD NOT have identifier slots
      - Classes instantiating this SHOULD be used with inlined=true
      - Classes instantiating this MAY compose other microschemas via attributes
    slots:
      - profile_version
      - semantic_mapping
      - domain_of_use

  ValueMicroschemaDefinition:
    class_uri: coms:ValueMicroschemaDefinition
    is_a: MicroschemaDefinition
    abstract: true
    description: >-
      A microschema representing a typed value with optional unit/system.
      Examples: Quantity, Timepoint, CodedValue, Range.

  #────────────────────────────────────────────────────────────────
  # VALUE MICROSCHEMAS: Leaf value types
  #────────────────────────────────────────────────────────────────

  Quantity:
    instantiates:
      - ValueMicroschemaDefinition
    class_uri: schema:QuantitativeValue
    description: >-
      A value with optional unit
    slots:
      - quantity_value
      - quantity_unit
      - comparator

  Timepoint:
    instantiates:
      - ValueMicroschemaDefinition
    description: >-
      A point in time, potentially relative
    slots:
      - datetime
      - relative_to_event
      - offset

  TimeInterval:
    instantiates:
      - ValueMicroschemaDefinition
    description: >-
      A period between two timepoints
    slots:
      - interval_start
      - interval_end
      - duration

  CodedValue:
    instantiates:
      - ValueMicroschemaDefinition
    description: >-
      A value from a controlled vocabulary
    slots:
      - code
      - code_label
      - code_system

  #────────────────────────────────────────────────────────────────
  # RECORD MICROSCHEMAS: Domain-specific composable data elements
  #────────────────────────────────────────────────────────────────

  ClinicalMeasurementRecord:
    instantiates:
      - MicroschemaDefinition
    description: >-
      A data structure with key and value attributes that represents a single observation.
      This can include results of clinical labs, scores and indices, socioeconomic, or
      behavioral observations.
    class_uri: bdchm:Observation
    annotations:
      domain_of_use: clinical
    slots:
      - subject_identifier
      - measurement_type
      - measurement_value
      - unit
      - method
      - instrument
      - reagent_kit
      - calculated_from
      - body_location
      - body_position
      - context
      - collected_by
      - data_type
      - age_at_measurement

  ConditionStatusRecord:
    instantiates:
      - MicroschemaDefinition
    description: >-
      Record suggesting the presence of a disease or medical condition stated as a diagnosis, sign, or symptom
    class_uri: bdchm:Condition
    annotations:
      domain_of_use: clinical
    slots:
      - subject_identifier
      - condition_type
      - associated_evidence
      - instrument
      - age_at_condition
      - condition_status
      - condition_provenance
      - condition_severity
      - relationship_to_participant

  DrugStatusRecord:
    instantiates:
      - MicroschemaDefinition
    description: >-
      Record suggesting exposure to a medication
    class_uri: bdchm:DrugExposure
    annotations:
      domain_of_use: clinical
    slots:
      - subject_identifier
      - drug_type
      - method
      - collected_by
      - age_at_drug
      - route_of_administration
      - dose
      - frequency
      - indication

  ProcedureStatusRecord:
    instantiates:
      - MicroschemaDefinition
    description: >-
      Record of activity or process ordered by or carried out by a healthcare provider for a diagnostic or therapeutic reason
    class_uri: bdchm:Procedure
    annotations:
      domain_of_use: clinical
    slots:
      - subject_identifier
      - procedure_type
      - method
      - collected_by
      - age_at_procedure

#────────────────────────────────────────────────────────────────
# EXAMPLES
#────────────────────────────────────────────────────────────────

  HumanBodyHeightRecord:
    is_a: ClinicalMeasurementRecord
    description: >-
      Measurement of linear distance of a human body from the bottom of a flat foot
      to the top-most point of the head
    rules:
      - preconditions:
          slot_conditions:
            meaurement_type:
              any_of:
                - equals_string: OBA:VT0001253
                - equals_string: OMOP:903133
                - equals_string: LOINC:3036277
      - postconditions:
          slot_conditions:
            unit:
              any_of:
                - equals_string: cm
                - equals_string: "[in_i]"
                - equals_string: m
                - equals_string: "[ft_i]"
            instrument:
              any_of:
                - equals_string: wall_mounted_stadiometer
                - equals_string: flexible_measuring_tape
                - equals_string: portable_stadiometer
                - equals_string: anthropometer_rod
                - equals_string: sonar_stadiometer
            body_position:
              any_of:
                - range: BodyPositionEnum
            data_type:
              equals_string: decimal
            measurement_value:
              range: decimal
              maximum_value: 300
              minimum_value: 0

  HumanBodyHeightRecord001:
    is_a: HumanBodyHeightRecord
    description: >-
      Measurement of linear distance of a standing human body from the bottom of a flat foot
      to the top-most point of the head measured with a wall-mounted stadiometer
    rules:
      - preconditions:
          slot_conditions:
            instrument:
              any_of:
                - equals_string: wall_mounted_stadiometer
            unit:
              any_of:
                - equals_string: cm
            body_position:
              any_of:
                - equals_string: standing
      - postconditions:
          slot_conditions:
            value:
              range: decimal
              maximum_value: 220
              minimum_value: 20
            unit:
              equals_string: cm
#────────────────────────────────────────────────────────────────
# SLOTS
#────────────────────────────────────────────────────────────────

slots:
  # Microschema profile slots
  profile_version:
    range: string
    description: Version of microschema profile this conforms to

  semantic_mapping:
    range: uriorcurie
    multivalued: true
    description: >-
      URIs/CURIEs mapping this microschema to external standards
      (ISO-11179 DEC, NIH CDE, etc.)

  domain_of_use:
    range: string
    multivalued: true
    description: Domains where this microschema is applicable

  # Value microschema slots
  quantity_value:
    range: decimal
    required: true
    description: The numeric value

  quantity_unit:
    range: uriorcurie
    slot_uri: schema:unitCode
    description: Unit (UCUM, UO, QUDT, etc.)

  comparator:
    range: ComparatorEnum
    description: Comparison operator (less than, greater than, etc.) or exact if null

  datetime:
    range: datetime
    description: Absolute timestamp

  relative_to_event:
    range: uriorcurie
    description: Event this is relative to

  offset:
    range: Quantity
    inlined: true
    description: Offset from event (e.g., "+3 days")

  interval_start:
    range: Timepoint
    inlined: true
    description: Start of the interval

  interval_end:
    range: Timepoint
    inlined: true
    description: End of the interval

  duration:
    range: Quantity
    inlined: true
    description: Duration as alternative to start/end

  code:
    range: uriorcurie
    required: true
    description: The code value as a CURIE

  code_label:
    range: string
    description: Human-readable label for the code

  code_system:
    range: uriorcurie
    description: The code system URI

  # Domain slots
  dose:
    range: Quantity
    description: Amount of drug per administration
  frequency:
    range: Quantity
    description: How often e.g. 2 per day
  indication:
    range: uriorcurie
    description: Condition/reason for drug (SNOMED, ICD, Mondo, HPO, etc)
  subject_identifier:
    range: string
    description: An identifier for the subject of the datum
  measurement_type:
    range: uriorcurie
    slot_uri: bdchm:observation_type
    description: A CURIE from OBA, OMOP, or LOINC
  unit:
    range: uriorcurie
    slot_uri: bdchm:unit
    description: A unit from UCUM
  method:
    range: MethodEnum
    slot_uri: bdchm:method_type
    description: The method used for the measurement
  instrument:
    range: InstrumentEnum
    description: The instrument used for the measurement
  reagent_kit:
    range: ReagentKitEnum
    description: The reagent kit used for the measurement
  calculated_from:
    description: An expression pointing at other CDE classes
  body_location:
    range: uriorcurie
    slot_uri: bdchm:BodySite
    description: A CURIE from UBERON
  body_position:
    range: BodyPositionEnum
    description: The body position during measurement
  context:
    range: ContextEnum
    description: The context of the measurement
  collected_by:
    range: CollectedByEnum
    description: Who collected the measurement
  condition_type:
    range: uriorcurie
    slot_uri: bdchm:condition_concept
    description: A CURIE from MONDO or HPO
  associated_evidence:
    range: AssociatedEvidenceEnum
    description: The method used for diagnosis
  drug_type:
    range: uriorcurie
    slot_uri: bdchm:drug_concept
    description: A CURIE from RxNorm
  procedure_type:
    range: uriorcurie
    slot_uri: bdchm:procedure_concept
    description: A CURIE from OMOP
  data_type:
    range: DataTypeEnum
    description: The data type of the observation
  age_at_measurement:
    range: Quantity
    description: Age of the subject at the time of measurement
  age_at_condition:
    range: TimeInterval
    description: Age of the subject at the start and end of the condition
  age_at_drug:
    range: TimeInterval
    description: Age of the subject at the start and end of drug exposure
  age_at_procedure:
    range: Quantity
    description: Age of the subject at the time of the procedure
  route_of_administration:
    range: RouteAdminEnum
    description: Routes of drug administration
  measurement_value:
    range: ValueMicroschemaDefinition
    description: The "value" in the observation key/value pair

#────────────────────────────────────────────────────────────────
# ENUMS
#────────────────────────────────────────────────────────────────

enums:
  RouteAdminEnum:
    description: Routes of drug administration
    permissible_values:
      oral:
        description: Oral administration
        meaning: OMOP:4132161
      intravenous:
        description: Intravenous administration
        meaning: OMOP:4171047
      intramuscular:
        description: Intramuscular administration
        meaning: OMOP:4302612
      subcutaneous:
        description: Subcutaneous administration
        meaning: OMOP:4142048
      intradermal:
        description: Intradermal administration
        meaning: OMOP:4156706
      transdermal:
        description: Transdermal administration
        meaning: OMOP:4262099
      rectal:
        description: Rectal administration
        meaning: OMOP:4290759
      vaginal:
        description: Vaginal administration
        meaning: OMOP:4057765
      nasal:
        description: Nasal administration
        meaning: OMOP:4262914
      topical:
        description: Topical administration
        meaning: OMOP:4263689
      sublingual:
        description: Sublingual administration
        meaning: OMOP:4292110
      buccal:
        description: Buccal administration
        meaning: OMOP:4181897
      intra_articular:
        description: Intra-articular administration
        meaning: OMOP:4006860
      intraperitoneal:
        description: Intraperitoneal administration
        meaning: OMOP:4243022
      intrathecal:
        description: Intrathecal administration
        meaning: OMOP:4217202
      epidural:
        description: Epidural administration
        meaning: OMOP:4225555
      intra_arterial:
        description: Intra-arterial administration
        meaning: OMOP:4240824
      ophthalmic:
        description: Ophthalmic administration
        meaning: OMOP:4184451
      otic:
        description: Otic (ear) administration
        meaning: OMOP:4023156
      enteral:
        description: Enteral administration
        meaning: OMOP:4167540
      percutaneous:
        description: Percutaneous administration
        meaning: OMOP:4177987

  ComparatorEnum:
    description: Comparator for quantity values
    permissible_values:
      lt:
        description: Less than
        meaning: coms:lt
      le:
        description: Less than or equal to
        meaning: coms:le
      ge:
        description: Greater than or equal to
        meaning: coms:ge
      gt:
        description: Greater than
        meaning: coms:gt

  DataTypeEnum:
    description: The data type of an observation value
    permissible_values:
      decimal:
        description: Decimal number
      integer:
        description: Integer number
      enum:
        description: Enumerated value
      boolean:
        description: Boolean value
  MethodEnum:
    description: The method used for a measurement or observation
    permissible_values:
      placeholder:
        description: Placeholder value
  InstrumentEnum:
    description: The instrument used for a measurement
    permissible_values:
      wall_mounted_stadiometer:
        description: >- 
          fixed, high-precision medical device used to measure human height, consisting
          of a vertical measuring rod or tape fastened to a wall with a sliding headpiece
        meaning: MMO:0000105
      mechanical_beam_balance_scale:
        description: >-
          medical device used to measure human weight
        meaning: MMO:0000087
  ReagentKitEnum:
    description: The reagent kit used for a measurement
    permissible_values:
      placeholder:
        description: Placeholder value
  BodyPositionEnum:
    description: The body position during a measurement
    permissible_values:
      supine:
        description: Lying face up
      standing:
        description: Standing upright
      sitting:
        description: Seated position
  ContextEnum:
    description: The context in which a measurement was taken
    permissible_values:
      fasted_8_hrs:
        description: Fasted for 8 hours
      fasted_12_hrs:
        description: Fasted for 12 hours
      before_bronchodilator:
        description: Before bronchodilator administration
      after_bronchodilator:
        description: After bronchodilator administration
      taking_lipid_lowering_medications:
        description: While taking lipid-lowering medications
      before_physical_activity:
        description: Before physical activity
      during_physical_activity:
        description: During physical activity
      after_physical_activity:
        description: After physical activity
      during_procedure:
        description: During a procedure
      taking_diabetes_medication:
        description: While taking diabetes medication
      lowest:
        description: Lowest recorded value
  CollectedByEnum:
    description: Who collected the measurement
    permissible_values:
      doctor:
        description: Collected by a doctor
      nurse:
        description: Collected by a nurse
      technician:
        description: Collected by a technician
      self_administered:
        description: Self-administered by the patient
      first_examiner:
        description: Collected by the first examiner
      second_examiner:
        description: Collected by the second examiner
  AssociatedEvidenceEnum:
    description: The method used for diagnosis
    permissible_values:
      placeholder:
        description: Placeholder value
